<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Login - Administração C.I. Plenitude</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        :root {
            --laranja-plenitude: #f97316;
        }
        .bg-laranja {
            background-color: var(--laranja-plenitude) !important;
        }
        .text-laranja {
            color: var(--laranja-plenitude) !important;
        }
        body {
            background: url('Imagem CIP 2025-09-25 à(s) 14.46.26_28b08d2a.jpg') no-repeat center center fixed;
            background-size: cover;
        }
    </style>
    <!-- Firebase App (core SDK) -->
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
    <script>
      const firebaseConfig = {
        apiKey: "AIzaSyAxuEEDjn6lPfKOysOcQjvWvUWqJL_990o",
        authDomain: "c-i-plenitude.firebaseapp.com",
        projectId: "c-i-plenitude",
        storageBucket: "c-i-plenitude.firebasestorage.app",
        messagingSenderId: "126733729315",
        appId: "1:126733729315:web:f6735a7904509d270fbb96",
        measurementId: "G-K6RHVQ3YLP"
      };
      firebase.initializeApp(firebaseConfig);
    </script>
</head>
<body>
    <header class="w-100 py-3 bg-laranja text-white text-center shadow-sm" style="position:fixed;top:0;left:0;z-index:10;">
      <span class="fw-bold fs-4">Administração - C.I. Plenitude</span>
    </header>
    <div class="d-flex align-items-center justify-content-center min-vh-100" style="padding-top:60px;padding-bottom:60px;">
      <div class="card shadow p-4" style="max-width: 350px; width: 100%; border: none; background: rgba(255,255,255,0.95);">
        <div class="text-center mb-3">
          <span class="fw-bold fs-4 text-laranja">Login</span>
        </div>
        <form id="login-form">
          <div class="mb-3">
            <label for="login-email" class="form-label">E-mail</label>
            <input type="email" class="form-control" id="login-email" placeholder="E-mail" required autofocus>
          </div>
          <div class="mb-3">
            <label for="login-password" class="form-label">Senha</label>
            <input type="password" class="form-control" id="login-password" placeholder="Senha" required>
          </div>
          <button type="submit" class="btn btn-laranja w-100">Entrar</button>
          <div id="login-error" class="text-danger mt-2 text-center" style="display:none;"></div>
        </form>
        <button id="logout-btn" class="btn btn-outline-secondary w-100 mt-2" style="display:none;">Sair</button>
      </div>
    </div>
    <footer class="w-100 py-2 bg-laranja text-white text-center shadow-sm" style="position:fixed;bottom:0;left:0;z-index:10;">
      <small>&copy; 2025 - Comunidade Internacional Plenitude</small>
    </footer>
    <script>
      document.addEventListener('DOMContentLoaded', function() {
        const loginForm = document.getElementById('login-form');
        const loginError = document.getElementById('login-error');
        const logoutBtn = document.getElementById('logout-btn');
        // Se já está autenticado, mostra botão de sair e esconde o formulário
        firebase.auth().onAuthStateChanged(function(user) {
          if (user) {
            loginForm.style.display = 'none';
            logoutBtn.style.display = 'block';
          } else {
            loginForm.style.display = 'block';
            logoutBtn.style.display = 'none';
          }
        });
        if (loginForm) {
          loginForm.addEventListener('submit', function(e) {
            e.preventDefault();
            const email = document.getElementById('login-email').value;
            const password = document.getElementById('login-password').value;
            firebase.auth().signInWithEmailAndPassword(email, password)
              .then(() => {
                loginError.style.display = 'none';
                window.location.href = 'admin.html';
              })
              .catch((error) => {
                let msg = 'Usuário ou senha inválidos.';
                if (error.code === 'auth/user-not-found') msg = 'Usuário não encontrado.';
                else if (error.code === 'auth/wrong-password') msg = 'Senha incorreta.';
                else if (error.code === 'auth/invalid-email') msg = 'E-mail inválido.';
                else if (error.code === 'auth/too-many-requests') msg = 'Muitas tentativas. Tente novamente mais tarde.';
                loginError.textContent = msg;
                loginError.style.display = 'block';
              });
          });
        }
        if (logoutBtn) {
          logoutBtn.addEventListener('click', function() {
            firebase.auth().signOut().then(() => {
              loginForm.style.display = 'block';
              logoutBtn.style.display = 'none';
            });
          });
        }
      });
    </script>
</body>
</html>
