<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Documentação de Segurança da Informação - Fundação</title>
    <!-- Inclui o Tailwind CSS via CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        /* Estilos base para o corpo da página */
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f0f2f5; /* Cor de fundo suave */
            display: flex;
            flex-direction: column; /* Alterado para coluna para acomodar o header */
            justify-content: flex-start; /* Alinhado ao topo */
            align-items: center;
            min-height: 100vh;
            padding: 0; /* Removido padding do body para controle total do header/main */
        }
        /* Estilos para o cabeçalho */
        header {
            width: 100%;
            background-color: #1e40af; /* Cor de fundo do cabeçalho (azul escuro) */
            padding: 1rem;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap; /* Permite que os itens do cabeçalho quebrem linha em telas pequenas */
            position: relative; /* Para z-index */
            z-index: 20; /* Acima da tela de boas-vindas */
        }
        header h1 {
            color: #ffffff; /* Texto branco */
            font-size: 1.5rem;
            font-weight: 700;
            margin-bottom: 0; /* Removido margin-bottom padrão */
        }
        header button {
            background-color: #3b82f6; /* Azul mais claro para o botão */
            color: #ffffff;
            padding: 0.5rem 1rem;
            border-radius: 0.5rem;
            font-weight: 600;
            transition: background-color 0.2s ease-in-out;
            cursor: pointer;
        }
        header button:hover {
            background-color: #2563eb; /* Azul um pouco mais escuro no hover */
        }

        /* Estilos para o container principal (main) */
        main {
            flex-grow: 1; /* Permite que o main ocupe o espaço restante */
            width: 100%;
            max-width: 6xl; /* Mantém a largura máxima do conteúdo */
            padding: 1rem; /* Padding para o conteúdo principal */
            margin-top: 1rem; /* Espaçamento entre o header e o main */
            opacity: 0; /* Inicialmente escondido */
            visibility: hidden; /* Inicialmente escondido */
            transition: opacity 0.5s ease-in-out, visibility 0.5s ease-in-out;
        }
        main.show {
            opacity: 1;
            visibility: visible;
        }

        /* Estilos adicionais para melhor visualização do conteúdo e espaçamento */
        h1, h2, h3, h4 {
            margin-bottom: 0.75rem;
        }
        p {
            margin-bottom: 1rem;
        }
        ul {
            list-style-type: disc;
            margin-left: 1.25rem;
            margin-bottom: 1rem;
        }
        li {
            margin-bottom: 0.5rem;
        }
        strong {
            font-weight: 600;
        }
        /* Estilos para grupos de formulário */
        .form-group {
            margin-bottom: 1.5rem;
        }
        .form-group label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 500;
            color: #374151;
        }
        .form-group input[type="text"],
        .form-group textarea,
        .form-group input[type="email"],
        .form-group input[type="password"],
        .form-group input[type="date"],
        .form-group input[type="tel"],
        .form-group select {
            width: 100%;
            padding: 0.75rem;
            border: 1px solid #d1d5db;
            border-radius: 0.5rem;
            font-size: 1rem;
            color: #374151;
            background-color: #f9fafb;
            transition: border-color 0.2s ease-in-out;
        }
        .form-group input[type="text"]:focus,
        .form-group textarea:focus,
        .form-group input[type="email"]:focus,
        .form-group input[type="password"]:focus,
        .form-group input[type="date"]:focus,
        .form-group input[type="tel"]:focus,
        .form-group select:focus {
            outline: none;
            border-color: #3b82f6;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.25);
        }
        /* Estilos para feedback de correção */
        .feedback {
            margin-top: 0.5rem;
            font-size: 0.875rem;
            font-weight: 500;
        }
        .feedback.correct {
            color: #10b981; /* green-500 */
        }
        .feedback.incorrect {
            color: #ef4444; /* red-500 */
        }
        /* Estilos para a caixa de resultados do questionário */
        .result-box {
            background-color: #e0f2fe; /* blue-100 */
            border: 1px solid #90cdf4; /* blue-300 */
            padding: 1.5rem;
            border-radius: 0.75rem;
            margin-top: 2rem;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        .result-box h3 {
            color: #1e40af; /* blue-800 */
            font-size: 1.25rem;
            font-weight: 700;
            margin-bottom: 1rem;
        }
        .result-box p {
            color: #1f2937; /* gray-800 */
            margin-bottom: 0.5rem;
        }

        /* Estilos para o modal de login */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.6); /* Fundo escuro semi-transparente */
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000; /* Garante que o modal esteja acima de outros elementos */
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s ease-in-out, visibility 0.3s ease-in-out;
        }
        .modal-overlay.show {
            opacity: 1;
            visibility: visible;
        }
        .modal-content {
            background-color: #ffffff;
            padding: 2rem;
            border-radius: 0.75rem;
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.2);
            width: 90%;
            max-width: 400px; /* Largura máxima para o modal */
            position: relative;
            transform: translateY(-20px); /* Efeito de entrada */
            transition: transform 0.3s ease-in-out;
        }
        .modal-overlay.show .modal-content {
            transform: translateY(0);
        }
        .modal-close-button {
            position: absolute;
            top: 1rem;
            right: 1rem;
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: #6b7280; /* gray-500 */
        }
        .modal-close-button:hover {
            color: #374151; /* gray-700 */
        }

        /* Estilos para a tela de boas-vindas */
        .welcome-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: #f0f2f5; /* Cor de fundo suave */
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
            z-index: 10; /* Abaixo do header e do modal */
            transition: opacity 0.5s ease-in-out, visibility 0.5s ease-in-out;
        }
        .welcome-screen.hidden {
            opacity: 0;
            visibility: hidden;
            pointer-events: none; /* Impede interação quando escondido */
        }
        .welcome-screen h2 {
            font-size: 2.5rem;
            font-weight: 700;
            color: #1e40af;
            margin-bottom: 1rem;
        }
        .welcome-screen p {
            font-size: 1.25rem;
            color: #4b5563;
            margin-bottom: 2rem;
            max-width: 600px;
            padding: 0 1rem;
        }
        .welcome-screen button {
            background-color: #3b82f6;
            color: #ffffff;
            padding: 1rem 2rem;
            border-radius: 0.75rem;
            font-weight: 600;
            font-size: 1.125rem;
            transition: background-color 0.2s ease-in-out;
            cursor: pointer;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        .welcome-screen button:hover {
            background-color: #2563eb;
        }
    </style>
</head>
<body class="antialiased">

    <!-- Cabeçalho com botão de Login -->
    <header role="banner">
        <h1 class="text-xl md:text-2xl">Documentação da Fundação</h1>
        <button id="loginButton" type="button" aria-label="Fazer login">Login</button>
    </header>

    <!-- Tela de Boas-Vindas (inicialmente visível) -->
    <div id="welcomeScreen" class="welcome-screen">
        <h2 class="text-4xl md:text-5xl">Bem-vindo à Documentação da Fundação!</h2>
        <p class="text-lg md:text-xl">
            Para aceder ao conteúdo completo e ao questionário de compreensão, por favor, faça login.
        </p>
        <button id="accessLoginButton" type="button" aria-label="Aceder à página de login">Fazer Login para Aceder</button>
    </div>

    <!-- Container principal que centraliza o card (inicialmente escondido) -->
    <main class="w-full max-w-6xl mx-auto p-4 md:p-6 lg:p-8" role="main">
        <!-- Flex Card Principal -->
        <div class="flex flex-col md:flex-row bg-white rounded-xl shadow-lg overflow-hidden">

            <!-- Seção da Esquerda (Menu/Navegação ou Resumo) -->
            <aside class="w-full md:w-1/3 p-6 bg-blue-50 md:border-r border-gray-200 flex flex-col justify-between" aria-label="Navegação Principal">
                <div>
                    <h2 class="text-xl md:text-2xl font-bold text-blue-800 mb-4">Visão Geral da Documentação</h2>
                    <p class="text-gray-700 text-sm mb-6">
                        Este card apresenta um resumo das principais documentações de segurança
                        e gestão da informação da Fundação.
                    </p>
                    <nav aria-label="Tópicos da Documentação">
                        <ul class="space-y-2">
                            <li>
                                <a href="#plano-continuidade" class="block p-3 rounded-lg text-blue-700 hover:bg-blue-100 font-medium transition duration-200">
                                    SG-PL-004 - Plano de Continuidade de Negócio
                                </a>
                            </li>
                            <li>
                                <a href="#plano-gestao" class="block p-3 rounded-lg text-gray-700 hover:bg-blue-100 font-medium transition duration-200">
                                    SG-PL-001 - Plano do Sistema de Gestão
                                </a>
                            </li>
                            <li>
                                <a href="#gestao-incidente" class="block p-3 rounded-lg text-gray-700 hover:bg-blue-100 font-medium transition duration-200">
                                    SG-PR-008 - Procedimento Gestão de Incidente
                                </a>
                            </li>
                            <li>
                                <a href="#politica-seguranca" class="block p-3 rounded-lg text-gray-700 hover:bg-blue-100 font-medium transition duration-200">
                                    SG-PO-002 - Política da Segurança da Informação
                                </a>
                            </li>
                            <li>
                                <a href="#politica-trabalho-remoto" class="block p-3 rounded-lg text-blue-700 hover:bg-blue-100 font-medium transition duration-200">
                                    SG-PO-003 - Política de Trabalho Remoto
                                </a>
                            </li>
                            <li>
                                <a href="#gestao-acesso" class="block p-3 rounded-lg text-blue-700 hover:bg-blue-100 font-medium transition duration-200">
                                    SG-PR-010 - Procedimento Gestão de Acesso
                                </a>
                            </li>
                            <li>
                                <a href="#questionario" class="block p-3 rounded-lg text-blue-700 hover:bg-blue-100 font-medium transition duration-200">
                                    Questionário
                                </a>
                            </li>
                            <li>
                                <a href="#profile-page" class="block p-3 rounded-lg text-blue-700 hover:bg-blue-100 font-medium transition duration-200">
                                    Meu Perfil
                                </a>
                            </li>
                        </ul>
                    </nav>
                </div>
                <!-- Botão de Ação na seção esquerda -->
                <button class="mt-8 w-full bg-blue-600 text-white py-3 px-4 rounded-lg hover:bg-blue-700 transition duration-300 shadow-md">
                    Acessar Documentos Completos
                </button>
            </aside>

            <!-- Seção da Direita (Conteúdo Principal da Documentação) -->
            <div class="w-full md:w-2/3 p-6 md:p-8 lg:p-10 flex flex-col justify-between">
                <div>
                    <h1 class="text-2xl md:text-3xl font-extrabold text-gray-900 mb-6">Documentações de Segurança e Gestão da Informação</h1>

                    <!-- Plano de Continuidade de Negócio -->
                    <section id="plano-continuidade" class="mb-8 pb-4 border-b border-gray-200" aria-labelledby="plano-continuidade-heading">
                        <h2 id="plano-continuidade-heading" class="text-xl md:text-2xl font-bold text-blue-700 mb-3">SG-PL-004 - Plano de Continuidade de Negócio (PCN)</h2>
                        <p class="text-gray-700 leading-relaxed">
                            O objetivo do PCN é definir regras e prover medidas rápidas e eficazes para os processos críticos de TI
                            em casos de incidentes graves ou desastres, garantindo a continuidade da prestação de serviços do Setor de Avaliação Digital.
                        </p>
                        <h3 class="text-lg font-semibold text-gray-800 mt-4 mb-2">Processos Vitais e Ameaças:</h3>
                        <ul class="text-gray-600 text-sm">
                            <li><strong>Processos Vitais:</strong> Desenvolvimento, Manutenção e Operação dos Sistemas (Servidores de Domínio GPO/CESGRANRIO, Azure DevOps, Rede, Desktops remotos).</li>
                            <li><strong>Ameaças:</strong> Humanas (erro, acesso indevido), Tecnológicas (falha de hardware/software, vírus, ataques cibernéticos, vazamento de dados), Infraestrutura (energia, refrigeração, nuvem), Naturais (incêndio, desastres naturais), Físicas (problemas estruturais).</li>
                        </ul>
                        <h3 class="text-lg font-semibold text-gray-800 mt-4 mb-2">Estratégias de Continuidade (PCN = PAC + PCO + PRD):</h3>
                        <ul class="text-gray-600 text-sm">
                            <li><strong>PAC (Programa de Administração de Crises):</strong> Gerir e comunicar ações durante uma crise.</li>
                            <li><strong>PCO (Plano de Continuidade Operacional):</strong> Manter o funcionamento dos principais serviços de TI e operações.</li>
                            <li><strong>PRD (Plano de Recuperação de Desastres):</strong> Restabelecer o nível de operação dos serviços no ambiente afetado.</li>
                        </ul>
                    </section>

                    <!-- Plano do Sistema de Gestão -->
                    <section id="plano-gestao" class="mb-8 pb-4 border-b border-gray-200" aria-labelledby="plano-gestao-heading">
                        <h2 id="plano-gestao-heading" class="text-xl md:text-2xl font-bold text-blue-700 mb-3">SG-PL-001 - Plano do Sistema de Gestão (SGSI)</h2>
                        <p class="text-gray-700 leading-relaxed">
                            O SGSI visa incorporar as atividades de gestão da Fundação através de processos,
                            procedimentos e planos para aplicar suas políticas e alcançar objetivos como minimizar riscos,
                            garantir segurança da informação e conformidade legal.
                        </p>
                        <h3 class="text-lg font-semibold text-gray-800 mt-4 mb-2">Escopo e Contexto:</h3>
                        <ul class="text-gray-600 text-sm">
                            <li><strong>Escopo:</strong> Coordenadoria de Avaliação Digital (desenvolvimento do GPO: GPO Web, Safe Browser, Pendrive).</li>
                            <li><strong>Contexto Interno:</strong> Estrutura organizacional, processos, políticas, responsabilidades, cultura, capacidade de recursos.</li>
                            <li><strong>Contexto Externo:</strong> Normas (ISO 27001), ambiente legal, social, tecnológico, político/econômico, mercado.</li>
                        </ul>
                        <h3 class="text-lg font-semibold text-gray-800 mt-4 mb-2">Liderança e Planejamento:</h3>
                        <ul class="text-gray-600 text-sm">
                            <li>A Alta Direção (Superintendência de Tecnologia e Inovação) garante o comprometimento e a melhoria contínua do SGSI.</li>
                            <li>O planejamento aborda riscos e oportunidades para garantir resultados, melhoria e minimizar efeitos indesejáveis.</li>
                        </ul>
                    </section>

                    <!-- Procedimento Gestão de Incidente -->
                    <section id="gestao-incidente" class="mb-8 pb-4 border-b border-gray-200" aria-labelledby="gestao-incidente-heading">
                        <h2 id="gestao-incidente-heading" class="text-xl md:text-2xl font-bold text-blue-700 mb-3">SG-PR-008 - Procedimento Gestão de Incidente</h2>
                        <p class="text-gray-700 leading-relaxed">
                            Este procedimento tem como objetivo restaurar a operação normal do serviço o mais rápido possível,
                            minimizando interrupções e impactos negativos, e gerenciar incidentes de segurança da informação.
                        </p>
                        <h3 class="text-lg font-semibold text-gray-800 mt-4 mb-2">Níveis de Atendimento (Hierarquia):</h3>
                        <ul class="text-gray-600 text-sm">
                            <li><strong>N1 (SIEM):</strong> Alterações em Ativos e Rede (Baixa a Média Criticidade).</li>
                            <li><strong>N2 (SIEM):</strong> Vulnerabilidades Média, Baixa e Informativa (Média Criticidade).</li>
                            <li><strong>N3 (CLAVIS):</strong> Vulnerabilidades Críticas (Alta a Crítica Criticidade).</li>
                            <li><strong>N4 (Cyber):</strong> Demandas de Cyber (Criticidade Variável).</li>
                            <li><strong>N5 (Incidentes de Segurança):</strong> Resposta a ameaças ativas (Máxima Criticidade).</li>
                        </ul>
                        <p class="text-gray-700 leading-relaxed mt-4">
                            A resolução e restauração são realizadas pelas Gerências de Suporte e Operações e Sistemas e Segurança,
                            com acompanhamento, comunicação e aceite do solicitante.
                        </p>
                    </section>

                    <!-- Política da Segurança da Informação -->
                    <section id="politica-seguranca" class="mb-8 pb-4 border-b border-gray-200" aria-labelledby="politica-seguranca-heading">
                        <h2 id="politica-seguranca-heading" class="text-xl md:text-2xl font-bold text-blue-700 mb-3">SG-PO-002 - Política da Segurança da Informação</h2>
                        <p class="text-gray-700 leading-relaxed">
                            A PSI estabelece diretrizes para a criação, transmissão, processamento, utilização, armazenamento,
                            recuperação e descarte de informações, visando preservar a <strong>Confidencialidade, Integridade e Disponibilidade (CID)</strong>.
                        </p>
                        <h3 class="text-lg font-semibold text-gray-800 mt-4 mb-2">Principais Seções e Controles:</h3>
                        <ul class="text-gray-600 text-sm">
                            <li><strong>Controle de Acesso:</strong> Proteção da identidade do colaborador, NDA, restrição de acesso a informações e funções.</li>
                            <li><strong>Política de Senha:</strong> Critérios de complexidade (mínimo 8 caracteres, 3 de 4 categorias), troca a cada 180 dias.</li>
                            <li><strong>Classificação da Informação:</strong> Pública, Corporativa, Confidencial (Dado Pessoal é confidencial).</li>
                            <li><strong>Segurança Física e do Ambiente:</strong> Prevenção de acesso não autorizado, identificação visível, proteção de equipamentos.</li>
                            <li><strong>Uso dos Ativos:</strong> Uso exclusivo para atividades profissionais, monitoramento, criptografia de mídias removíveis e discos rígidos de notebooks.</li>
                            <li><strong>Trabalho Remoto:</strong> Acesso via VDI, proibição de e-mails pessoais para assuntos corporativos.</li>
                            <li><strong>Backup:</strong> Estratégias para proteger dados contra perda, testes periódicos de restauração.</li>
                            <li><strong>Gestão de Incidentes de Segurança:</strong> Identificação, avaliação, registro e resposta eficaz a incidentes.</li>
                            <li><strong>Processo Disciplinar:</strong> Sanções para não conformidade (Advertência Verbal/Escrita, Suspensão, Demissão).</li>
                        </ul>
                    </section>

                    <!-- Política de Trabalho Remoto -->
                    <section id="politica-trabalho-remoto" class="mb-8 pb-4 border-b border-gray-200" aria-labelledby="politica-trabalho-remoto-heading">
                        <h2 id="politica-trabalho-remoto-heading" class="text-xl md:text-2xl font-bold text-blue-700 mb-3">SG-PO-003 - Política de Trabalho Remoto</h2>
                        <p class="text-gray-700 leading-relaxed">
                            Define a política de Segurança da Informação (SI) e privacidade para o trabalho em Home-Office,
                            aplicável a todos os colaboradores que utilizam equipamentos da Fundação ou particulares.
                        </p>
                        <h3 class="text-lg font-semibold text-gray-800 mt-4 mb-2">Condições e Uso Aceitável:</h3>
                        <ul class="text-gray-600 text-sm">
                            <li>Acesso remoto via Horizon VDI Client.</li>
                            <li>Proibido realizar atividades para terceiros com ganho pessoal.</li>
                            <li>Proibido transmissão de material ilícito, informações sem autorização, fotos/gravações para uso pessoal.</li>
                            <li>Equipamentos corporativos sujeitos a monitoramento e inspeção.</li>
                            <li>Informações confidenciais/sensíveis devem ser criptografadas (Cesgransec).</li>
                            <li>Proibido armazenar informações pessoais em equipamentos corporativos ou corporativas em equipamentos particulares.</li>
                            <li>Uso exclusivo de e-mails corporativos para comunicações institucionais.</li>
                        </ul>
                        <h3 class="text-lg font-semibold text-gray-800 mt-4 mb-2">Proteção e Responsabilidades:</h3>
                        <ul class="text-gray-600 text-sm">
                            <li>Proteger equipamentos contra acesso não autorizado (bloqueio de tela, evitar Wi-Fi públicas).</li>
                            <li>Reportar incidentes de segurança (ramal 9190 ou helpdesk).</li>
                            <li>RH e Gerência de Sistemas e Segurança são responsáveis por manter a política e conscientizar.</li>
                        </ul>
                    </section>

                    <!-- Procedimento Gestão de Acesso -->
                    <section id="gestao-acesso" class="mb-8 pb-4" aria-labelledby="gestao-acesso-heading">
                        <h2 id="gestao-acesso-heading" class="text-xl md:text-2xl font-bold text-blue-700 mb-3">SG-PR-010 - Procedimento Gestão de Acesso</h2>
                        <p class="text-gray-700 leading-relaxed">
                            O objetivo é garantir que as permissões e níveis de acesso (físico e lógico) estejam apropriados
                            às atividades, aplicando o princípio do menor privilégio, e mitigar o risco de acesso não autorizado.
                        </p>
                        <h3 class="text-lg font-semibold text-gray-800 mt-4 mb-2">Controle de Acesso Físico:</h3>
                        <ul class="text-gray-600 text-sm">
                            <li><strong>Identificação:</strong> Crachás (cores diferentes para funcionários determinados/indeterminados, prestadores, estagiários, visitantes, provisórios).</li>
                            <li><strong>Acesso:</strong> Controlado pela Coordenadoria de Segurança e Patrimônio. Locais de segurança máxima protegidos por biometria (Data Center).</li>
                            <li><strong>Remoção/Bloqueio:</strong> Realizada em caso de desligamento, término de contrato, perda/furto de crachá, férias/licença/suspensão.</li>
                        </ul>
                        <h3 class="text-lg font-semibold text-gray-800 mt-4 mb-2">Controle de Acesso Lógico:</h3>
                        <ul class="text-gray-600 text-sm">
                            <li><strong>Sistemas:</strong> Rede Intranet, Microsoft Azure, W-access, Service Desk, Office 365, etc.</li>
                            <li><strong>Criação/Remoção:</strong> Gerência de Suporte e Operações (AD cesgranrio.org.br) e Gerência de Sistemas e Segurança (AD cesgpon.com.br).</li>
                            <li><strong>Senhas:</strong> Temporárias no 1º acesso, troca obrigatória, redefinição via plataforma Microsoft.com.</li>
                            <li><strong>Bloqueio de Login:</strong> Após 3 tentativas erradas ou em casos de férias/licença/suspensão.</li>
                        </ul>
                        <p class="text-gray-700 leading-relaxed mt-4">
                            A revisão dos perfis de acesso (físico e lógico) é realizada anualmente para garantir conformidade.
                        </p>
                    </section>

                    <!-- Novo Questionário -->
                    <section id="questionario" class="mb-8 pb-4" aria-labelledby="questionario-heading">
                        <h2 id="questionario-heading" class="text-xl md:text-2xl font-bold text-blue-700 mb-3">Questionário de Compreensão</h2>
                        <p class="text-gray-700 leading-relaxed mb-6">
                            Por favor, responda às seguintes perguntas para testar a sua compreensão sobre os documentos de segurança da informação da Fundação.
                        </p>

                        <form id="quizForm" class="space-y-6">
                            <!-- Seção: Plano de Continuidade de Negócio (SG-PL-004) -->
                            <h3 class="text-lg font-semibold text-gray-800 mt-6 mb-3">Plano de Continuidade de Negócio</h3>
                            <div class="form-group" id="q1-group">
                                <label for="q1">1. Qual é o principal objetivo do Plano de Continuidade de Negócio (PCN)?</label>
                                <input type="text" id="q1" name="q1" placeholder="A sua resposta aqui..." class="rounded-lg" aria-describedby="q1-feedback">
                                <div class="feedback" id="q1-feedback"></div>
                            </div>
                            <div class="form-group" id="q8-group">
                                <label for="q8">2. No Plano de Continuidade de Negócio (PCN), qual a diferença entre RPO (Recovery Point Objective) e RTO (Recovery Time Objective)?</label>
                                <textarea id="q8" name="q8" rows="3" placeholder="A sua resposta aqui..." class="rounded-lg" aria-describedby="q8-feedback"></textarea>
                                <div class="feedback" id="q8-feedback"></div>
                            </div>

                            <!-- Seção: Plano do Sistema de Gestão (SG-PL-001) -->
                            <h3 class="text-lg font-semibold text-gray-800 mt-6 mb-3">Plano do Sistema de Gestão</h3>
                            <div class="form-group" id="q6-group">
                                <label for="q6">3. Qual o objetivo do SGSI (Sistema de Gestão da Segurança da Informação) em relação aos riscos, conforme o Plano do Sistema de Gestão?</label>
                                <textarea id="q6" name="q6" rows="3" placeholder="A sua resposta aqui..." class="rounded-lg" aria-describedby="q6-feedback"></textarea>
                                <div class="feedback" id="q6-feedback"></div>
                            </div>
                            <div class="form-group" id="q9-group">
                                <label for="q9">4. Qual é o escopo do SGSI, conforme o Plano do Sistema de Gestão?</label>
                                <input type="text" id="q9" name="q9" placeholder="A sua resposta aqui..." class="rounded-lg" aria-describedby="q9-feedback">
                                <div class="feedback" id="q9-feedback"></div>
                            </div>
                            <div class="form-group" id="q10-group">
                                <label for="q10">5. Quem é a "Alta Direção" considerada no Sistema de Gestão da Segurança da Informação?</label>
                                <input type="text" id="q10" name="q10" placeholder="A sua resposta aqui..." class="rounded-lg" aria-describedby="q10-feedback">
                                <div class="feedback" id="q10-feedback"></div>
                            </div>

                            <!-- Seção: Procedimento Gestão de Incidente (SG-PR-008) -->
                            <h3 class="text-lg font-semibold text-gray-800 mt-6 mb-3">Procedimento Gestão de Incidente</h3>
                            <div class="form-group" id="q3-group">
                                <label for="q3">6. No Procedimento Gestão de Incidente, qual é o Nível 5 (N5) e qual o seu foco principal?</label>
                                <textarea id="q3" name="q3" rows="3" placeholder="A sua resposta aqui..." class="rounded-lg" aria-describedby="q3-feedback"></textarea>
                                <div class="feedback" id="q3-feedback"></div>
                            </div>
                            <div class="form-group" id="q11-group">
                                <label aria-labelledby="q11-label">7. Quais são os meios formais para colaboradores e prestadores da Fundação relatarem um incidente?</label>
                                <div id="q11-label" class="sr-only">Meios formais para relatar um incidente</div>
                                <div class="flex items-center mb-2">
                                    <input type="checkbox" id="q11a" name="q11" value="Service Desk" class="form-checkbox text-blue-600 rounded">
                                    <label for="q11a" class="ml-2 text-gray-700">Service Desk no módulo de Segurança da Informação</label>
                                </div>
                                <div class="flex items-center mb-2">
                                    <input type="checkbox" id="q11b" name="q11" value="Ligacao telefônica" class="form-checkbox text-blue-600 rounded">
                                    <label for="q11b" class="ml-2 text-gray-700">Por ligação telefônica no ramal 9190</label>
                                </div>
                                <div class="flex items-center mb-2">
                                    <input type="checkbox" id="q11c" name="q11" value="Email" class="form-checkbox text-blue-600 rounded">
                                    <label for="q11c" class="ml-2 text-gray-700">Por e-mail para o gestor</label>
                                </div>
                                <div class="feedback" id="q11-feedback"></div>
                            </div>

                            <!-- Seção: Política da Segurança da Informação (SG-PO-002) -->
                            <h3 class="text-lg font-semibold text-gray-800 mt-6 mb-3">Política da Segurança da Informação</h3>
                            <div class="form-group" id="q2-group">
                                <label aria-labelledby="q2-label">8. Quais são os três princípios de segurança da informação que a Política de Segurança da Informação visa preservar?</label>
                                <div id="q2-label" class="sr-only">Princípios de segurança da informação</div>
                                <div class="flex items-center mb-2">
                                    <input type="checkbox" id="q2a" name="q2" value="Confidencialidade" class="form-checkbox text-blue-600 rounded">
                                    <label for="q2a" class="ml-2 text-gray-700">Confidencialidade</label>
                                </div>
                                <div class="flex items-center mb-2">
                                    <input type="checkbox" id="q2b" name="q2" value="Integridade" class="form-checkbox text-blue-600 rounded">
                                    <label for="q2b" class="ml-2 text-gray-700">Integridade</label>
                                </div>
                                <div class="flex items-center mb-2">
                                    <input type="checkbox" id="q2c" name="q2" value="Disponibilidade" class="form-checkbox text-blue-600 rounded">
                                    <label for="q2c" class="ml-2 text-gray-700">Disponibilidade</label>
                                </div>
                                <div class="flex items-center mb-2">
                                    <input type="checkbox" id="q2d" name="q2" value="Transparência" class="form-checkbox text-blue-600 rounded">
                                    <label for="q2d" class="ml-2 text-gray-700">Transparência</label>
                                </div>
                                <div class="feedback" id="q2-feedback"></div>
                            </div>
                            <div class="form-group" id="q7-group">
                                <label aria-labelledby="q7-label">9. De acordo com a Política de Segurança da Informação, quais são os requisitos mínimos para senhas de acesso à rede?</label>
                                <div id="q7-label" class="sr-only">Requisitos mínimos para senhas de acesso à rede</div>
                                <div class="flex items-center mb-2">
                                    <input type="checkbox" id="q7a" name="q7" value="Minimo 6 caracteres" class="form-checkbox text-blue-600 rounded">
                                    <label for="q7a" class="ml-2 text-gray-700">Mínimo 6 caracteres</label>
                                </div>
                                <div class="flex items-center mb-2">
                                    <input type="checkbox" id="q7b" name="q7" value="Minimo 8 caracteres" class="form-checkbox text-blue-600 rounded">
                                    <label for="q7b" class="ml-2 text-gray-700">Mínimo 8 caracteres</label>
                                </div>
                                <div class="flex items-center mb-2">
                                    <input type="checkbox" id="q7c" name="q7" value="Nao conter nome da conta ou 2 caracteres consecutivos do nome" class="form-checkbox text-blue-600 rounded">
                                    <label for="q7c" class="ml-2 text-gray-700">Não conter nome da conta ou mais de 2 caracteres consecutivos de partes do nome completo do usuário</label>
                                </div>
                                <div class="flex items-center mb-2">
                                    <input type="checkbox" id="q7d" name="q7" value="Conter caracteres de 3 de 4 categorias" class="form-checkbox text-blue-600 rounded">
                                    <label for="q7d" class="ml-2 text-gray-700">Conter caracteres de 3 destas 4 categorias (Maiúsculos, Minúsculos, Números, Não alfabéticos)</label>
                                </div>
                                <div class="flex items-center mb-2">
                                    <input type="checkbox" id="q7e" name="q7" value="Troca a cada 90 dias" class="form-checkbox text-blue-600 rounded">
                                    <label for="q7e" class="ml-2 text-gray-700">Troca em intervalos máximos de 90 dias</label>
                                </div>
                                <div class="flex items-center mb-2">
                                    <input type="checkbox" id="q7f" name="q7" value="Troca a cada 180 dias" class="form-checkbox text-blue-600 rounded">
                                    <label for="q7f" class="ml-2 text-gray-700">Troca em intervalos máximos de 180 dias</label>
                                </div>
                                <div class="feedback" id="q7-feedback"></div>
                            </div>
                            <div class="form-group" id="q12-group">
                                <label aria-labelledby="q12-label">10. Qual a classificação de sigilo de "Dado Pessoal" na Política de Segurança da Informação?</label>
                                <div id="q12-label" class="sr-only">Classificação de sigilo de Dado Pessoal</div>
                                <div class="flex items-center mb-2">
                                    <input type="radio" id="q12a" name="q12" value="Publica" class="form-radio text-blue-600">
                                    <label for="q12a" class="ml-2 text-gray-700">Pública</label>
                                </div>
                                <div class="flex items-center mb-2">
                                    <input type="radio" id="q12b" name="q12" value="Corporativa" class="form-radio text-blue-600">
                                    <label for="q12b" class="ml-2 text-gray-700">Corporativa</label>
                                </div>
                                <div class="flex items-center mb-2">
                                    <input type="radio" id="q12c" name="q12" value="Confidencial" class="form-radio text-blue-600">
                                    <label for="q12c" class="ml-2 text-gray-700">Confidencial</label>
                                </div>
                                <div class="feedback" id="q12-feedback"></div>
                            </div>
                            <div class="form-group" id="q13-group">
                                <label for="q13">11. O que é proibido em relação à instalação de software, conforme a Política de Segurança da Informação?</label>
                                <textarea id="q13" name="q13" rows="3" placeholder="A sua resposta aqui..." class="rounded-lg" aria-describedby="q13-feedback"></textarea>
                                <div class="feedback" id="q13-feedback"></div>
                            </div>

                            <!-- Seção: Política de Trabalho Remoto (SG-PO-003) -->
                            <h3 class="text-lg font-semibold text-gray-800 mt-6 mb-3">Política de Trabalho Remoto</h3>
                            <div class="form-group" id="q4-group">
                                <label aria-labelledby="q4-label">12. De acordo com a Política de Trabalho Remoto, é permitido usar e-mails pessoais para tratar de assuntos corporativos?</label>
                                <div id="q4-label" class="sr-only">Permissão para usar e-mails pessoais para assuntos corporativos</div>
                                <div class="flex items-center mb-2">
                                    <input type="radio" id="q4a" name="q4" value="Sim" class="form-radio text-blue-600">
                                    <label for="q4a" class="ml-2 text-gray-700">Sim</label>
                                </div>
                                <div class="flex items-center mb-2">
                                    <input type="radio" id="q4b" name="q4" value="Não" class="form-radio text-blue-600">
                                    <label for="q4b" class="ml-2 text-gray-700">Não</label>
                                </div>
                                <div class="feedback" id="q4-feedback"></div>
                            </div>

                            <!-- Seção: Procedimento Gestão de Acesso (SG-PR-010) -->
                            <h3 class="text-lg font-semibold text-gray-800 mt-6 mb-3">Procedimento Gestão de Acesso</h3>
                            <div class="form-group" id="q5-group">
                                <label for="q5">13. Qual é a principal responsabilidade da Coordenadoria de Segurança e Patrimônio no controle de acesso físico, conforme o Procedimento Gestão de Acesso?</label>
                                <input type="text" id="q5" name="q5" placeholder="A sua resposta aqui..." class="rounded-lg" aria-describedby="q5-feedback">
                                <div class="feedback" id="q5-feedback"></div>
                            </div>
                            <div class="form-group" id="q14-group">
                                <label aria-labelledby="q14-label">14. No Procedimento Gestão de Acesso, qual a cor do crachá para "Funcionário determinado" e "Prestador de serviço"?</label>
                                <div id="q14-label" class="sr-only">Cor do crachá para Funcionário determinado e Prestador de serviço</div>
                                <div class="flex items-center mb-2">
                                    <input type="radio" id="q14a" name="q14" value="Determinado: Verde, Prestador: Laranja" class="form-radio text-blue-600">
                                    <label for="q14a" class="ml-2 text-gray-700">Funcionário determinado: Verde; Prestador de serviço: Laranja</label>
                                </div>
                                <div class="flex items-center mb-2">
                                    <input type="radio" id="q14b" name="q14" value="Determinado: Azul, Prestador: Verde" class="form-radio text-blue-600">
                                    <label for="q14b" class="ml-2 text-gray-700">Funcionário determinado: Azul; Prestador de serviço: Verde</label>
                                </div>
                                <div class="flex items-center mb-2">
                                    <input type="radio" id="q14c" name="q14" value="Determinado: Laranja, Prestador: Azul" class="form-radio text-blue-600">
                                    <label for="q14c" class="ml-2 text-gray-700">Funcionário determinado: Laranja; Prestador de serviço: Azul</label>
                                </div>
                                <div class="feedback" id="q14-feedback"></div>
                            </div>

                            <button type="submit" class="w-full bg-green-600 text-white py-3 px-4 rounded-lg hover:bg-green-700 transition duration-300 shadow-md">
                                Enviar Respostas
                            </button>
                        </form>

                        <div id="quiz-results" class="result-box hidden">
                            <h3>Resultados do Questionário</h3>
                            <p id="score-display"></p>
                            <div id="individual-feedback"></div>
                        </div>
                    </section>

                    <!-- Seção Meu Perfil -->
                    <section id="profile-page" class="mb-8 pb-4" aria-labelledby="profile-page-heading">
                        <h2 id="profile-page-heading" class="text-xl md:text-2xl font-bold text-blue-700 mb-3">Meu Perfil</h2>
                        <div id="profile-content" class="text-gray-700">
                            <p>Carregando seus resultados anteriores...</p>
                        </div>
                    </section>

                </div>

                <!-- Rodapé da Seção Direita -->
                <div class="mt-8 pt-6 border-t border-gray-200 text-sm text-gray-500">
                    Resumo gerado com base nas documentações da Fundação.
                    Última atualização: 18 de Julho de 2025
                </div>
            </div>

        </div>
    </main>

    <!-- Modal de Login/Cadastro -->
    <div id="authModal" class="modal-overlay" role="dialog" aria-modal="true" aria-labelledby="auth-modal-title">
        <div class="modal-content">
            <button id="closeAuthModalButton" class="modal-close-button" aria-label="Fechar janela de autenticação">&times;</button>
            <h2 id="auth-modal-title" class="text-2xl font-bold text-gray-900 mb-6 text-center">Login</h2>

            <!-- Formulário de Login -->
            <form id="loginFormAuth" class="space-y-4">
                <div class="form-group">
                    <label for="loginEmail">E-mail:</label>
                    <input type="email" id="loginEmail" name="loginEmail" placeholder="seu.email@exemplo.com" required class="rounded-lg">
                </div>
                <div class="form-group">
                    <label for="loginPassword">Senha:</label>
                    <input type="password" id="loginPassword" name="loginPassword" placeholder="Sua senha" required class="rounded-lg">
                </div>
                <button type="submit" class="w-full bg-blue-600 text-white py-3 px-4 rounded-lg hover:bg-blue-700 transition duration-300 shadow-md">
                    Entrar
                </button>
                <div class="text-center text-sm text-gray-600 mt-4">
                    <a href="#" class="text-blue-600 hover:underline" id="forgotPasswordLink">Esqueceu a senha?</a>
                </div>
                <div class="text-center mt-4">
                    <button type="button" id="googleLoginButton" class="w-full bg-red-600 text-white py-3 px-4 rounded-lg hover:bg-red-700 transition duration-300 shadow-md flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M22.675 12.115c0-.78-.068-1.535-.195-2.262H12v4.512h6.182c-.276 1.388-1.07 2.56-2.28 3.348l-.011.011 3.85 2.99a10.027 10.027 0 003.064-7.609z" fill="#4285F4"/>
                            <path d="M12 23c2.972 0 5.46-1.01 7.28-2.75l-3.85-2.99a5.617 5.617 0 01-3.43 1.18c-2.651 0-4.906-1.79-5.71-4.22H2.96v3.018A9.993 9.993 0 0012 23z" fill="#34A853"/>
                            <path d="M6.29 14.28c-.2-.59-.31-1.23-.31-1.88s.11-1.29.31-1.88V7.59H2.96A9.993 9.993 0 002 12c0 1.33.308 2.6.85 3.75l3.44-2.72z" fill="#FBBC04"/>
                            <path d="M12 5.5c1.62 0 3.06.56 4.21 1.64L19.49 3.4C17.61 1.25 14.97 0 12 0A9.993 9.993 0 002.85 7.59l3.44 2.72C7.094 8.29 9.349 6.5 12 6.5z" fill="#EA4335"/>
                        </svg>
                        Login com Google
                    </button>
                </div>
                <p class="text-center text-sm text-gray-600 mt-4">
                    Não tem uma conta? <a href="#" class="text-blue-600 hover:underline" id="showRegisterForm">Cadastre-se</a>
                </p>
                <div id="loginMessage" class="feedback text-center"></div>
            </form>

            <!-- Formulário de Cadastro -->
            <form id="registerForm" class="space-y-4 hidden">
                <div class="form-group">
                    <label for="registerName">Nome:</label>
                    <input type="text" id="registerName" name="registerName" placeholder="Seu nome" required class="rounded-lg">
                </div>
                <div class="form-group">
                    <label for="registerSurname">Sobrenome:</label>
                    <input type="text" id="registerSurname" name="registerSurname" placeholder="Seu sobrenome" required class="rounded-lg">
                </div>
                <div class="form-group">
                    <label for="registerGender">Gênero:</label>
                    <select id="registerGender" name="registerGender" class="rounded-lg">
                        <option value="">Selecione</option>
                        <option value="Masculino">Masculino</option>
                        <option value="Feminino">Feminino</option>
                        <option value="Nao binario">Não Binário</option>
                        <option value="Prefiro nao informar">Prefiro não informar</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="registerDOB">Data de Nascimento:</label>
                    <input type="date" id="registerDOB" name="registerDOB" required class="rounded-lg">
                </div>
                <div class="form-group">
                    <label for="registerPhone">Celular (DDD) XXXXX-XXXX:</label>
                    <input type="tel" id="registerPhone" name="registerPhone" placeholder="(XX) XXXXX-XXXX" pattern="\(\d{2}\) \d{5}-\d{4}" maxlength="15" required class="rounded-lg">
                </div>
                <div class="form-group">
                    <label for="registerEmail">E-mail:</label>
                    <input type="email" id="registerEmail" name="registerEmail" placeholder="seu.email@exemplo.com" required class="rounded-lg">
                </div>
                <div class="form-group">
                    <label for="registerPassword">Senha:</label>
                    <input type="password" id="registerPassword" name="registerPassword" placeholder="Crie uma senha" required class="rounded-lg">
                </div>
                <div class="form-group">
                    <label for="confirmPassword">Confirmar Senha:</label>
                    <input type="password" id="confirmPassword" name="confirmPassword" placeholder="Confirme sua senha" required class="rounded-lg">
                </div>
                <button type="submit" class="w-full bg-green-600 text-white py-3 px-4 rounded-lg hover:bg-green-700 transition duration-300 shadow-md">
                    Cadastrar
                </button>
                <p class="text-center text-sm text-gray-600 mt-4">
                    Já tem uma conta? <a href="#" class="text-blue-600 hover:underline" id="showLoginForm">Fazer Login</a>
                </p>
                <div id="registerMessage" class="feedback text-center"></div>
            </form>
        </div>
    </div>

    <script type="module">
        // Importa as funções necessárias do Firebase SDK
        import { initializeApp } from "https://www.gstatic.com/firebasejs/12.0.0/firebase-app.js";
        import { getAnalytics } from "https://www.gstatic.com/firebasejs/12.0.0/firebase-analytics.js";
        import { getAuth, signInWithEmailAndPassword, createUserWithEmailAndPassword, GoogleAuthProvider, signInWithPopup, onAuthStateChanged, signOut, updateProfile } from "https://www.gstatic.com/firebasejs/12.0.0/firebase-auth.js";
        import { getFirestore, collection, addDoc, query, where, getDocs, Timestamp } from "https://www.gstatic.com/firebasejs/12.0.0/firebase-firestore.js";

        // Configuração do Firebase (substitua pelos seus dados reais)
        const firebaseConfig = {
            apiKey: "AIzaSyDGk1KVF_cGeodVY4pYbufNntIfR45g5RE",
            authDomain: "estudos-9ec57.firebaseapp.com",
            projectId: "estudos-9ec57",
            storageBucket: "estudos-9ec57.firebasestorage.app",
            messagingSenderId: "431061056443",
            appId: "1:431061056443:web:0c661d5eb2bfb79cd1229e",
            measurementId: "G-C8BMRN2X7M"
        };

        // Inicializa o Firebase
        const app = initializeApp(firebaseConfig);
        const analytics = getAnalytics(app);
        const auth = getAuth(app); // Obtém a instância de autenticação
        const db = getFirestore(app); // Obtém a instância do Firestore

        // Variável global para o ID da aplicação (usada para caminhos no Firestore)
        const appId = typeof __app_id !== 'undefined' ? __app_id : 'default-app-id';


        // Elementos do DOM relacionados ao modal de autenticação
        const authModal = document.getElementById('authModal');
        const loginButton = document.getElementById('loginButton');
        const closeAuthModalButton = document.getElementById('closeAuthModalButton');
        const loginFormAuth = document.getElementById('loginFormAuth');
        const registerForm = document.getElementById('registerForm');
        const showRegisterFormLink = document.getElementById('showRegisterForm');
        const showLoginFormLink = document.getElementById('showLoginForm');
        const googleLoginButton = document.getElementById('googleLoginButton');
        const authModalTitle = document.getElementById('auth-modal-title');
        const loginMessageDiv = document.getElementById('loginMessage');
        const registerMessageDiv = document.getElementById('registerMessage');
        const welcomeScreen = document.getElementById('welcomeScreen');
        const mainContent = document.querySelector('main');
        const accessLoginButton = document.getElementById('accessLoginButton');
        const profileContentDiv = document.getElementById('profile-content');

        // Elementos do novo formulário de cadastro
        const registerNameInput = document.getElementById('registerName');
        const registerSurnameInput = document.getElementById('registerSurname');
        const registerGenderSelect = document.getElementById('registerGender');
        const registerDOBInput = document.getElementById('registerDOB');
        const registerPhoneInput = document.getElementById('registerPhone');


        // Listener para o estado de autenticação do usuário
        onAuthStateChanged(auth, (user) => {
            if (user) {
                // Usuário está logado
                loginButton.textContent = `Olá, ${user.displayName || user.email}`;
                loginButton.removeEventListener('click', openAuthModal);
                loginButton.addEventListener('click', signOutUser);
                welcomeScreen.classList.add('hidden'); // Esconde a tela de boas-vindas
                mainContent.classList.add('show'); // Mostra o conteúdo principal
                loadQuizResults(user.uid); // Carrega os resultados do questionário para o perfil
            } else {
                // Usuário está deslogado
                loginButton.textContent = 'Login';
                loginButton.removeEventListener('click', signOutUser); // Correção: remove o listener signOutUser
                loginButton.addEventListener('click', openAuthModal); // Adiciona listener para abrir modal
                welcomeScreen.classList.remove('hidden'); // Mostra a tela de boas-vindas
                mainContent.classList.remove('show'); // Esconde o conteúdo principal
                profileContentDiv.innerHTML = '<p>Faça login para ver seus resultados.</p>'; // Limpa o perfil
            }
        });

        // Função para abrir o modal de autenticação
        function openAuthModal() {
            authModal.classList.add('show');
            authModalTitle.textContent = 'Login';
            loginFormAuth.classList.remove('hidden');
            registerForm.classList.add('hidden');
            loginMessageDiv.textContent = ''; // Limpa mensagens anteriores
            registerMessageDiv.textContent = '';
            document.getElementById('loginEmail').focus(); // Foca o campo de e-mail
        }

        // Função para fazer logout
        function signOutUser() {
            signOut(auth).then(() => {
                // Logout bem-sucedido, onAuthStateChanged vai lidar com a UI
            }).catch((error) => {
                console.error("Erro ao fazer logout:", error);
                // Implementar feedback de erro adequado, sem alert()
            });
        }

        // Listeners para o modal de autenticação
        loginButton.addEventListener('click', openAuthModal); // Configuração inicial, será substituída por onAuthStateChanged
        accessLoginButton.addEventListener('click', openAuthModal); // Botão "Fazer Login para Aceder" na tela de boas-vindas

        closeAuthModalButton.addEventListener('click', () => {
            authModal.classList.remove('show');
            loginButton.focus();
        });
        authModal.addEventListener('click', (event) => {
            if (event.target === authModal) {
                authModal.classList.remove('show');
                loginButton.focus();
            }
        });

        // Alternar entre formulários de Login e Cadastro
        showRegisterFormLink.addEventListener('click', (e) => {
            e.preventDefault();
            authModalTitle.textContent = 'Cadastro';
            loginFormAuth.classList.add('hidden');
            registerForm.classList.remove('hidden');
            registerMessageDiv.textContent = '';
            document.getElementById('registerEmail').focus();
        });

        showLoginFormLink.addEventListener('click', (e) => {
            e.preventDefault();
            authModalTitle.textContent = 'Login';
            loginFormAuth.classList.remove('hidden');
            registerForm.classList.add('hidden');
            loginMessageDiv.textContent = '';
            document.getElementById('loginEmail').focus();
        });

        // Lógica de Login com E-mail e Senha
        loginFormAuth.addEventListener('submit', async (e) => {
            e.preventDefault();
            const email = document.getElementById('loginEmail').value;
            const password = document.getElementById('loginPassword').value;
            loginMessageDiv.textContent = '';

            try {
                await signInWithEmailAndPassword(auth, email, password);
                loginMessageDiv.textContent = 'Login bem-sucedido!';
                loginMessageDiv.className = "feedback correct";
                setTimeout(() => {
                    authModal.classList.remove('show');
                }, 1000);
            } catch (error) {
                let errorMessage = "Erro ao fazer login. Verifique suas credenciais.";
                if (error.code === 'auth/user-not-found' || error.code === 'auth/wrong-password') {
                    errorMessage = "E-mail ou senha inválidos.";
                } else if (error.code === 'auth/invalid-email') {
                    errorMessage = "Formato de e-mail inválido.";
                } else if (error.code === 'auth/too-many-requests') {
                    errorMessage = "Muitas tentativas de login. Tente novamente mais tarde.";
                }
                loginMessageDiv.textContent = errorMessage;
                loginMessageDiv.className = "feedback incorrect";
                console.error("Erro de login:", error);
            }
        });

        // Lógica de Login com Google
        googleLoginButton.addEventListener('click', async () => {
            const provider = new GoogleAuthProvider();
            try {
                await signInWithPopup(auth, provider);
                loginMessageDiv.textContent = 'Login com Google bem-sucedido!';
                loginMessageDiv.className = "feedback correct";
                setTimeout(() => {
                    authModal.classList.remove('show');
                }, 1000);
            } catch (error) {
                let errorMessage = "Erro ao fazer login com Google.";
                if (error.code === 'auth/popup-closed-by-user') {
                    errorMessage = "Login com Google cancelado.";
                } else if (error.code === 'auth/cancelled-popup-request') {
                    errorMessage = "Já existe uma janela de login aberta. Por favor, feche-a e tente novamente.";
                } else if (error.code === 'auth/auth-domain-config-required' || error.code === 'auth/configuration-not-found') {
                    errorMessage = "Erro de configuração do Firebase para login com Google. Por favor, verifique se o provedor Google está ativado e se o domínio da sua aplicação está adicionado aos domínios autorizados no console do Firebase (Autenticação > Configurações > Domínios autorizados).";
                }
                loginMessageDiv.textContent = errorMessage;
                loginMessageDiv.className = "feedback incorrect";
                console.error("Erro de login com Google:", error);
            }
        });

        // Lógica de Cadastro de Nova Conta
        registerForm.addEventListener('submit', async (e) => {
            e.preventDefault();
            const name = registerNameInput.value;
            const surname = registerSurnameInput.value;
            const gender = registerGenderSelect.value;
            const dob = registerDOBInput.value;
            const phone = registerPhoneInput.value;
            const email = document.getElementById('registerEmail').value;
            const password = document.getElementById('registerPassword').value;
            const confirmPassword = document.getElementById('confirmPassword').value;
            registerMessageDiv.textContent = '';

            if (password !== confirmPassword) {
                registerMessageDiv.textContent = "As senhas não coincidem.";
                registerMessageDiv.className = "feedback incorrect";
                return;
            }

            try {
                const userCredential = await createUserWithEmailAndPassword(auth, email, password);
                const user = userCredential.user;

                // Atualizar perfil do usuário com nome e sobrenome
                await updateProfile(user, {
                    displayName: `${name} ${surname}`
                });

                // Salvar informações adicionais do usuário no Firestore
                await addDoc(collection(db, 'artifacts', appId, 'users', user.uid, 'profile'), {
                    name: name,
                    surname: surname,
                    gender: gender,
                    dateOfBirth: dob,
                    phone: phone,
                    email: email,
                    registrationDate: Timestamp.now()
                });

                registerMessageDiv.textContent = 'Cadastro bem-sucedido! Você já está logado.';
                registerMessageDiv.className = "feedback correct";
                setTimeout(() => {
                    authModal.classList.remove('show');
                }, 1000);
            } catch (error) {
                let errorMessage = "Erro ao cadastrar.";
                if (error.code === 'auth/email-already-in-use') {
                    errorMessage = "Este e-mail já está em uso.";
                } else if (error.code === 'auth/weak-password') {
                    errorMessage = "A senha é muito fraca (mínimo de 6 caracteres).";
                } else if (error.code === 'auth/invalid-email') {
                    errorMessage = "Formato de e-mail inválido.";
                }
                registerMessageDiv.textContent = errorMessage;
                registerMessageDiv.className = "feedback incorrect";
                console.error("Erro de cadastro:", error);
            }
        });

        // Lógica de formatação do celular
        registerPhoneInput.addEventListener('input', (e) => {
            let value = e.target.value.replace(/\D/g, ''); // Remove tudo que não é dígito
            let formattedValue = '';

            if (value.length > 0) {
                formattedValue = '(' + value.substring(0, 2); // DDD
            }
            if (value.length >= 3) {
                formattedValue += ') ' + value.substring(2, 7); // Primeiros 5 dígitos
            }
            if (value.length >= 8) {
                formattedValue += '-' + value.substring(7, 11); // Últimos 4 dígitos
            }
            e.target.value = formattedValue;
        });
        registerPhoneInput.addEventListener('keydown', (e) => {
            // Permite Backspace, Delete, Tab, Escape, Enter e as teclas de seta
            if (e.key === 'Backspace' || e.key === 'Delete' || e.key === 'Tab' || e.key === 'Escape' || e.key === 'Enter' || e.key.startsWith('Arrow')) {
                return;
            }
            // Limita o comprimento total do campo formatado
            if (e.target.value.length >= 15 && e.key.match(/\d/)) { // (XX) XXXXX-XXXX
                e.preventDefault();
            }
        });


        // Lógica do questionário
        document.getElementById('quizForm').addEventListener('submit', async function(event) {
            event.preventDefault();

            const answersData = {
                q1: { expected: "Definir regras e prover medidas rápidas e eficazes para os processos críticos de TI em casos de incidentes graves ou desastres, garantindo a continuidade da prestação de serviços do Setor de Avaliação Digital.", keywords: ["continuar negócio", "garantir continuidade", "prover medidas rápidas e eficazes"] },
                q2: { expected: ["Confidencialidade", "Integridade", "Disponibilidade"], type: "checkbox" },
                q3: { expected: "Nível 5 (N5) trata de incidentes de segurança, ou seja, eventos que indicam ataques em andamento ou comprometimento do ambiente. Seu foco principal é a contenção, erradicação e recuperação do incidente, minimizando impactos para a organização.", keywords: ["incidentes de segurança", "contenção", "erradicação", "recuperação"] },
                q4: { expected: "Não", type: "radio" },
                q5: { expected: "A principal responsabilidade da Coordenadoria de Segurança e Patrimônio é controlar o acesso físico ao edifício sede, incluindo a criação e manutenção de perfis de acesso, associação de crachás e liberação/revogação de direitos de acesso físico.", keywords: ["controlar acesso físico", "criação e manutenção de perfis de acesso", "associação de crachás"] },
                q6: { expected: "Minimizar os riscos ao negócio, garantir a segurança da informação e conformidade com requisitos legais.", keywords: ["minimizar riscos", "garantir segurança", "conformidade legal"] },
                q7: { expected: ["Minimo 8 caracteres", "Nao conter nome da conta ou 2 caracteres consecutivos do nome", "Conter caracteres de 3 de 4 categorias", "Troca a cada 180 dias"], type: "checkbox" },
                q8: { expected: "RPO (Recovery Point Objective) é a frequência ou o tempo necessário que backups precisam ser feitos para que dados não sejam perdidos. RTO (Recovery Time Objective) é o período de tempo após um incidente dentro do qual um produto ou serviço ou atividade é retomada.", keywords: ["rpo frequencia", "rto tempo", "rpo tempo necessario", "rto periodo de tempo"] },
                q9: { expected: "A Coordenadoria de Avaliação Digital, que é responsável por desenvolver de forma segura a solução do Gerenciador de Provas Online GPO, que faz parte de um ecossistema para aplicação de Avaliação Digital segura, que por sua vez compreende o GPO Web, o GPO Safe Browser e o GPO Pendrive.", keywords: ["coordenadoria de avaliação digital", "gpo web", "gpo safe browser", "gpo pendrive"] },
                q10: { expected: "Superintendência de Tecnologia e Inovação", keywords: ["superintendência de tecnologia e inovação", "superintendencia de tecnologia e inovacao"] },
                q11: { expected: ["Service Desk", "Ligacao telefônica"], type: "checkbox" },
                q12: { expected: "Confidencial", type: "radio" },
                q13: { expected: "É proibida a instalação de software, sem que estejam devidamente identificados, licenciados e homologados pela FUNDAÇÃO. Não é permitido o download de software, programas, jogos, executáveis da Internet ou de quaisquer outros meios para os computadores da FUNDAÇÃO sem o devido processo formal.", keywords: ["proibida a instalação de software", "sem que estejam devidamente identificados", "licenciados e homologados", "não é permitido o download de software"] },
                q14: { expected: "Determinado: Verde, Prestador: Laranja", type: "radio" }
            };

            let score = 0;
            const totalQuestions = Object.keys(answersData).length;
            const individualFeedbackDiv = document.getElementById('individual-feedback');
            individualFeedbackDiv.innerHTML = ''; // Limpa feedbacks anteriores
            const userQuizAnswers = {}; // Para armazenar as respostas do usuário e o feedback

            // Função para normalizar strings (remover acentos, converter para minúsculas e remover espaços extras)
            const normalizeString = (str) => {
                return str.normalize("NFD").replace(/[\u0300-\u036f]/g, "").toLowerCase().trim().replace(/\s+/g, ' ');
            };

            // Processar cada questão
            for (const qId in answersData) {
                const qData = answersData[qId];
                const feedbackElement = document.getElementById(`${qId}-feedback`);
                let isQuestionCorrect = false;
                let questionScore = 0; // Pontuação para a questão atual (0 a 1)
                let userResponse = '';

                if (qData.type === "checkbox") {
                    const selectedValues = Array.from(document.querySelectorAll(`input[name="${qId}"]:checked`)).map(cb => cb.value);
                    userResponse = selectedValues.join(', ');
                    let correctSelections = 0;
                    let incorrectSelections = 0;

                    qData.expected.forEach(expectedVal => {
                        if (selectedValues.includes(expectedVal)) {
                            correctSelections++;
                        }
                    });

                    selectedValues.forEach(selectedVal => {
                        if (!qData.expected.includes(selectedVal)) {
                            incorrectSelections++;
                        }
                    });

                    // Pontuação parcial: +1 por resposta correta selecionada, -1 por resposta incorreta selecionada
                    // Garante que a pontuação não seja negativa
                    questionScore = Math.max(0, (correctSelections - incorrectSelections) / qData.expected.length);
                    isQuestionCorrect = (correctSelections === qData.expected.length && incorrectSelections === 0);

                    if (isQuestionCorrect) {
                        feedbackElement.textContent = "Correto!";
                        feedbackElement.className = "feedback correct";
                        score += 1; // Adiciona 1 ponto completo para questões totalmente corretas
                    } else if (questionScore > 0) {
                        feedbackElement.textContent = `Parcialmente correto. Você acertou ${correctSelections} e errou ${incorrectSelections} opções. Resposta esperada: ${qData.expected.join(', ')}. Sua resposta: ${userResponse}`;
                        feedbackElement.className = "feedback incorrect";
                        score += questionScore; // Adiciona a fração da pontuação
                    }
                    else {
                        feedbackElement.textContent = `Incorreto. Resposta esperada: ${qData.expected.join(', ')}. Sua resposta: ${userResponse}`;
                        feedbackElement.className = "feedback incorrect";
                    }

                } else if (qData.type === "radio") {
                    const selectedValue = document.querySelector(`input[name="${qId}"]:checked`)?.value;
                    userResponse = selectedValue || 'Nenhuma';
                    isQuestionCorrect = (selectedValue === qData.expected);

                    if (isQuestionCorrect) {
                        feedbackElement.textContent = "Correto!";
                        feedbackElement.className = "feedback correct";
                        score += 1;
                    } else {
                        feedbackElement.textContent = `Incorreto. Resposta esperada: ${qData.expected}. Sua resposta: ${userResponse}`;
                        feedbackElement.className = "feedback incorrect";
                    }
                } else { // Tipo texto (input ou textarea)
                    const userAnswer = normalizeString(document.getElementById(qId).value);
                    userResponse = document.getElementById(qId).value; // Manter a resposta original para exibição
                    let matchedKeywords = 0;
                    qData.keywords.forEach(keyword => {
                        if (userAnswer.includes(normalizeString(keyword))) {
                            matchedKeywords++;
                        }
                    });

                    // Pontuação parcial para texto: baseado no número de palavras-chave corretas
                    questionScore = (matchedKeywords > 0) ? (matchedKeywords / qData.keywords.length) : 0;
                    isQuestionCorrect = (matchedKeywords === qData.keywords.length); // Considera 100% se todas as keywords baterem

                    if (isQuestionCorrect) {
                        feedbackElement.textContent = "Correto!";
                        feedbackElement.className = "feedback correct";
                        score += 1;
                    } else if (questionScore > 0) {
                        feedbackElement.textContent = `Parcialmente correto. Sua resposta contém ${matchedKeywords} palavras-chave corretas. Resposta esperada: ${qData.expected}`;
                        feedbackElement.className = "feedback incorrect";
                        score += questionScore;
                    }
                    else {
                        feedbackElement.textContent = `Incorreto. Resposta esperada: ${qData.expected}`;
                        feedbackElement.className = "feedback incorrect";
                    }
                }
                individualFeedbackDiv.innerHTML += `<p><strong>Questão ${qId.replace('q', '')}:</strong> <span class="${feedbackElement.className.includes('correct') ? 'text-green-600' : 'text-red-600'}">${feedbackElement.textContent}</span></p>`;
                userQuizAnswers[qId] = {
                    question: document.querySelector(`label[for="${qId}"]`)?.textContent || `Questão ${qId.replace('q', '')}`,
                    userAnswer: userResponse,
                    isCorrect: isQuestionCorrect,
                    feedback: feedbackElement.textContent,
                    scoreEarned: questionScore.toFixed(2) // Pontuação ganha na questão
                };
            }

            const finalScore = (score / totalQuestions) * 100; // Pontuação em porcentagem
            const scoreDisplay = document.getElementById('score-display');
            scoreDisplay.textContent = `Você acertou ${score.toFixed(1)} de ${totalQuestions} perguntas. Sua nota final é: ${finalScore.toFixed(2)}%.`;
            document.getElementById('quiz-results').classList.remove('hidden');

            // Salvar resultados no Firestore
            if (auth.currentUser) {
                try {
                    const userId = auth.currentUser.uid;
                    await addDoc(collection(db, 'artifacts', appId, 'users', userId, 'quiz_results'), {
                        timestamp: Timestamp.now(),
                        score: finalScore.toFixed(2),
                        totalQuestions: totalQuestions,
                        correctAnswers: score.toFixed(1),
                        userAnswers: userQuizAnswers // Salva as respostas detalhadas do usuário
                    });
                    console.log("Resultados do questionário salvos com sucesso!");
                    loadQuizResults(userId); // Recarrega os resultados no perfil após salvar
                } catch (e) {
                    console.error("Erro ao salvar resultados do questionário no Firestore:", e);
                }
            }
        });


        // Função para carregar e exibir resultados anteriores do questionário
        async function loadQuizResults(userId) {
            profileContentDiv.innerHTML = '<p>Carregando seus resultados anteriores...</p>';
            try {
                // Consulta ordenada por timestamp para mostrar os mais recentes primeiro
                const q = query(collection(db, 'artifacts', appId, 'users', userId, 'quiz_results'));
                const querySnapshot = await getDocs(q);

                if (querySnapshot.empty) {
                    profileContentDiv.innerHTML = '<p>Você ainda não tem resultados de questionários.</p>';
                    return;
                }

                let resultsHtml = '<h3 class="text-lg font-semibold text-gray-800 mb-2">Meus Resultados Anteriores:</h3>';
                querySnapshot.forEach((doc) => {
                    const data = doc.data();
                    const date = data.timestamp ? new Date(data.timestamp.seconds * 1000).toLocaleString('pt-BR') : 'Data Indisponível';
                    resultsHtml += `
                        <div class="bg-blue-50 p-4 rounded-lg mb-4 shadow-sm">
                            <p><strong>Data:</strong> ${date}</p>
                            <p><strong>Nota:</strong> ${data.score}% (${parseFloat(data.correctAnswers).toFixed(1)} de ${data.totalQuestions} corretas)</p>
                            <button class="toggle-answers text-blue-600 hover:underline mt-2 text-sm" data-answers='${JSON.stringify(data.userAnswers)}'>Ver Respostas Detalhadas</button>
                            <div class="detailed-answers hidden mt-2 text-sm bg-blue-100 p-3 rounded-md"></div>
                        </div>
                    `;
                });
                profileContentDiv.innerHTML = resultsHtml;

                // Adicionar listeners para os botões "Ver Respostas Detalhadas"
                document.querySelectorAll('.toggle-answers').forEach(button => {
                    button.addEventListener('click', (e) => {
                        const detailedAnswersDiv = e.target.nextElementSibling;
                        if (detailedAnswersDiv.classList.contains('hidden')) {
                            const answers = JSON.parse(e.target.dataset.answers);
                            let answersHtml = '<ul class="list-none p-0">'; // Removido bullets padrão
                            for (const qId in answers) {
                                const answer = answers[qId];
                                const questionText = answer.question.split('?')[0] + '?'; // Pega só a parte da pergunta
                                const feedbackClass = answer.isCorrect ? 'text-green-600' : 'text-red-600';
                                answersHtml += `
                                    <li class="mb-2">
                                        <p><strong>${questionText}</strong></p>
                                        <p>Sua resposta: <em>${answer.userAnswer || 'Não respondida'}</em></p>
                                        <p class="${feedbackClass}">${answer.feedback}</p>
                                        <p>Pontuação: ${answer.scoreEarned || '0.00'}</p>
                                    </li>
                                `;
                            }
                            answersHtml += '</ul>';
                            detailedAnswersDiv.innerHTML = answersHtml;
                            detailedAnswersDiv.classList.remove('hidden');
                            e.target.textContent = 'Esconder Respostas Detalhadas';
                        } else {
                            detailedAnswersDiv.classList.add('hidden');
                            e.target.textContent = 'Ver Respostas Detalhadas';
                        }
                    });
                });

            } catch (e) {
                console.error("Erro ao carregar resultados do questionário:", e);
                profileContentDiv.innerHTML = '<p class="text-red-600">Ocorreu um erro ao carregar seus resultados. Tente novamente mais tarde.</p>';
            }
        }
    </script>
</body>
</html>
